import aiohttp
import asyncio

host = 'dev-sng-both1'


async def sign_order(session, amount):
    data = {
        'opportunity': {
            "chain_id": "op_sepolia",
            "opportunity_id": "c0341345-4705-4a28-b6e5-be0ba3d0f240",
            "permission_key": "0x0000000000000000000000001473b9739cadcd0c298b218cea3b244be23b5725000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000025",
            "target_contract": "0x1473b9739cadcd0c298b218cea3b244be23b5725",
            "target_calldata": "0x8895951c0000000000000000000000000000000000000000000000000000000000000025000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000056000000000000000000000000000000000000000000000000000000000000004e3504e41550100000003b801000000030d01c4a53d66702cd27a560e3edad3a9d05e85ba21aa3cf2aac44e3dff5b5719e1b42edb94ca6124f47911c4c595deee033dcf6543068bfe36a9a2c24f337201f9a300028cfde5ca328d43e0833365bfa466a92aff0e8fcc1b451021a888d3fb8231f463148c36d43121e179fa8e01cdea7a9f3a116f07296e3e06f8861044c0e776c8660103fbe2dece576352323b86c166c8602c813cedab743bde4658e314bf4ebd079f31159d5b69ddfdcee5ab5f4507a4322b47e0ab47a08001f934048b1e84f8a33a3b0004bc51c9c931507cb322876603714a0dffeda7287309b6c4d10a810adaf39a1754423fa10a158de4f18eec8e33bba5e359157eccb1e2eb367a5814ac6edfbfdfef00065238e76eb11e9252e5890450bdc738e9166726a33a6c9394e0bb355c1a63b4a96bfe143c9260a94b6969e51fc72c5c947e8a7bfb80f88081651918b69d2ac776010844ceac721d001e546e4de58f9669ce5b0b40276a8d455c65370891e2a533bf95551c1d97d2bafb75e2c297402ce9d5ba56fce184be9fa86055a80a09fa3d8e90000a3cc0986d78388537c39e93f91ed438099b409dd56f76e635bb528433991c9ea17c53990e71939f67361f1f8a2645d2f40a1e0c3d1d5a7e7b3052aca201274910010b160521cd8f182582c4714776d51667bbf4d1caec76f0dd2f8f2da76b773cda947710f8723a6c7f43a983c7d2af2773e2c9ef7c600af6bae74d76bbebda9a4c19010c4ee1a2ad5248a6b5c6ac99a64cd3e27a16a28eb009c4e0b77a78000b7ca64cd429c647cf6db7f3d4dc1c4b315021db5147efe5bd1daf768bbdf4c34317830fa6000da60576e408613d8eaa2cd7964956631ffda717a766a024dc6cd566490d5c69230a69ba90e1dccd07d02ea892b52a2da3e3bdfac6f9e6a1e8ab9ac899155510ce000e41f595f4d7df09b07c2507f13808357e4a5c351137e775c720c0ae5d09e25c8009137e963f317fb2907806ed1d0f5d70ba8049c9efa5b6acf555609b48b4ded80110a4ba1f5aeffabeb430e5720197074720f636aec6d4f2d4d9c2798af802a011df19da8da06a775ce5b3e774f309331789877f8ce6bf990f2f485fac6d463c8ce400124c9f94aa1b732f12c2c686afdbaaae000b1583e3bce7bcfa02c23d8f478f8e0b2ebca2aaa40b6ecde034ac9f3a6a1f5817f118d2014e35eadbe6a6581337b5170065fcd8ae00000000001ae101faedac5851e32b9b23b5f9411a8c2bac4aae3ed4dd7b811dd1a72ea4aa710000000002c0999c0141555756000000000007c9ef27000027101ead8db9ae4057e28e2e8ef194cc913bf3ac788701005500e62df6c8b4a85fe1a67db44dc12de5db330f7ac66b72dc658afedf0f4a415b43000005faf993888200000000d308603afffffff80000000065fcd8ae0000000065fcd8ad000005f756eaf62000000000db1a756c0a762a0fc4b67d2baf1ccc962517e2662e7217bac8823b9e9ab78530c608647e54dc05ce83202a8b0f935f237c4487cb6e5c2b78e8179a8375593ca637c9326ff6d7601d33b8878d1a5c8e3797c46c8ceea9b4a17c662e23ee8b5eac47d68fdd9f25fd05d6e08d1f54d551e29fa3d81742e88cc04f191f0192b9a1d27f17efd3fe12f04c351dfb7c487555d118d1f6dd99411c3b1089e43db6dd039731045a40ae345fda7a7980407adb9ac965095543b76b594f6aadd680aa7a1b81786f73fadd68f4f7224ad35e15000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004e3504e41550100000003b801000000030d01c4a53d66702cd27a560e3edad3a9d05e85ba21aa3cf2aac44e3dff5b5719e1b42edb94ca6124f47911c4c595deee033dcf6543068bfe36a9a2c24f337201f9a300028cfde5ca328d43e0833365bfa466a92aff0e8fcc1b451021a888d3fb8231f463148c36d43121e179fa8e01cdea7a9f3a116f07296e3e06f8861044c0e776c8660103fbe2dece576352323b86c166c8602c813cedab743bde4658e314bf4ebd079f31159d5b69ddfdcee5ab5f4507a4322b47e0ab47a08001f934048b1e84f8a33a3b0004bc51c9c931507cb322876603714a0dffeda7287309b6c4d10a810adaf39a1754423fa10a158de4f18eec8e33bba5e359157eccb1e2eb367a5814ac6edfbfdfef00065238e76eb11e9252e5890450bdc738e9166726a33a6c9394e0bb355c1a63b4a96bfe143c9260a94b6969e51fc72c5c947e8a7bfb80f88081651918b69d2ac776010844ceac721d001e546e4de58f9669ce5b0b40276a8d455c65370891e2a533bf95551c1d97d2bafb75e2c297402ce9d5ba56fce184be9fa86055a80a09fa3d8e90000a3cc0986d78388537c39e93f91ed438099b409dd56f76e635bb528433991c9ea17c53990e71939f67361f1f8a2645d2f40a1e0c3d1d5a7e7b3052aca201274910010b160521cd8f182582c4714776d51667bbf4d1caec76f0dd2f8f2da76b773cda947710f8723a6c7f43a983c7d2af2773e2c9ef7c600af6bae74d76bbebda9a4c19010c4ee1a2ad5248a6b5c6ac99a64cd3e27a16a28eb009c4e0b77a78000b7ca64cd429c647cf6db7f3d4dc1c4b315021db5147efe5bd1daf768bbdf4c34317830fa6000da60576e408613d8eaa2cd7964956631ffda717a766a024dc6cd566490d5c69230a69ba90e1dccd07d02ea892b52a2da3e3bdfac6f9e6a1e8ab9ac899155510ce000e41f595f4d7df09b07c2507f13808357e4a5c351137e775c720c0ae5d09e25c8009137e963f317fb2907806ed1d0f5d70ba8049c9efa5b6acf555609b48b4ded80110a4ba1f5aeffabeb430e5720197074720f636aec6d4f2d4d9c2798af802a011df19da8da06a775ce5b3e774f309331789877f8ce6bf990f2f485fac6d463c8ce400124c9f94aa1b732f12c2c686afdbaaae000b1583e3bce7bcfa02c23d8f478f8e0b2ebca2aaa40b6ecde034ac9f3a6a1f5817f118d2014e35eadbe6a6581337b5170065fcd8ae00000000001ae101faedac5851e32b9b23b5f9411a8c2bac4aae3ed4dd7b811dd1a72ea4aa710000000002c0999c0141555756000000000007c9ef27000027101ead8db9ae4057e28e2e8ef194cc913bf3ac788701005500ef0d8b6fda2ceba41da15d4095d1da392a0d2f8ed0c6c7bc0f4cfac8c280b56d00000004269a0fe00000000000ec86c8fffffff80000000065fcd8ae0000000065fcd8ad000000042c9590b80000000000e337b50a4fb762fefaa7cd2b70f442fcada2d63f8e977ae4432a6795e08d2e46829a0d2d202cf11e0a4c30be4727e0a9dc51f626407680bfab9b402093ef132de7c53368942cbc00da97f70e0aa06fd7832e5742a9b4a17c662e23ee8b5eac47d68fdd9f25fd05d6e08d1f54d551e29fa3d81742e88cc04f191f0192b9a1d27f17efd3fe12f04c351dfb7c487555d118d1f6dd99411c3b1089e43db6dd039731045a40ae345fda7a7980407adb9ac965095543b76b594f6aadd680aa7a1b81786f73fadd68f4f7224ad35e150000000000000000000000000000000000000000000000000000000000",
            "target_call_value": "2",
            "sell_tokens": [{"token":"0x193ad24beedfaf27f217395f52fa20c7a36d79b3","amount":"1966065077841479060"},{"token":"0x74a4a85c611679b73f402b36c0f84a7d2ccdfda3","amount":"2"}],
            "buy_tokens": [{"token":"0x3745007f7c8dd8bec89b3b35f33f13f58b008533","amount":"5723622164778189"}],
            "eip_712_domain": {
                "name": "OpportunityAdapter",
                "version": "1",
                "chain_id": "11155420",
                "verifying_contract": "0xabc"
            }
        },
        'amount': amount,
        'valid_until': 2**256 - 1
    }

    async with session.post(f'http://{host}:1980/private/order-signature', json=data) as response:
        status = response.status
        print(f'Received status {status}')
        text = await response.text()
        print(f'Received text: {text}')


async def main():
    async with aiohttp.ClientSession() as session:
        print('Getting order signature...')
        await sign_order(session, 10)

        print('Test DONE')


asyncio.get_event_loop().run_until_complete(main())
